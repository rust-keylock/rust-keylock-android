dist: trusty
language: android

jdk:
  - oraclejdk8
addons:
  apt:
    packages:
    - oracle-java8-installer
android:
  components:
    - platform-tools
    - tools
    - build-tools-26.0.2
    - android-16

before_install:
  - sudo apt-get update -qq
  - sudo apt-get install -qq gcc-arm-linux-androideabi
  - sh rust-build/pre_build_rust_keylock_android.sh
  - sh rust-build/build_rust_for_rust_keylock_android.sh

script:
  - mvn -f java/pom.xml clean install

deploy:
  provider: releases
  api_key:
    secure: QAFSbUoyNv/1/lkSzS4SBXwozKkk3Hnjlio6aH6akEniFBhkG93+8SUHLFl/O7MR74IpCG4iIm+E7Lo8sZR/xkk5SJgvw2ts4se06b5QmSy0AFjdWuaPJvJpF3WCnOmNiOa/MNBQdnQGoBHDtkmiZM/k4TX4sZfOKN5JEzItt9rSF23koAdnGvwwiaihjIcA1kOLFcGYmzNQF3qwBsnwwhsTHINGwvXcpbLWF6/3pYWXcnPDL/h2Vb+iTg+fG4KBHLK3l7jXarJmqy2uOHs6Nabz1e0KDEoWrUH1GXKzPBfxyXpTXhwIek7iI95QF/eiFgsHlYuX0fAwSRqs5zVEwmx+vmoi5GwaTId1DeY82yn6jl+a5fPFRFVz6DRBQwIu6GgQnMHuijnDrNGim4jrYmDaKHSA+9eK9luXZsXFCxHwTAHRdeWWebK0CdHDr+r3BP9kCzHxmOopwvxt/x3/AZwEAPlNPfLKVFdnKSx7J71lUkiJIjxDOnijWBhmFeOgb7VlHc2Fhg9EZ+/+DD0g+o6IfVqvdBSInD39ynnU8KJVJDWyykyjK45hmZDRCNdN3ns2pSTU7KPS5orTtAOMKs0VPh66/S9aP2TO0W2IUtaY3oyg83g8hCr+BIamyLhA1QQDdlHd7wgy2sNdmt+vVi/KEHGxSw2f/3U3y2XmQMY=

  file: java/target/rust-keylock-android-0.3.0.apk
  skip_cleanup: true
  on:
    repo: rust-keylock/rust-keylock-android
    tags: true
